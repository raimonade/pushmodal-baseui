import{jsx as n,Fragment as e}from"react/jsx-runtime";import{useEffect as r,useState as t,Suspense as o,useLayoutEffect as a}from"react";import{Dialog as p}from"@base-ui/react/dialog";var i=function(){return i=Object.assign||function(n){for(var e,r=1,t=arguments.length;r<t;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n},i.apply(this,arguments)};function u(n,e,r){if(r||2===arguments.length)for(var t,o=0,a=e.length;o<a;o++)!t&&o in e||(t||(t=Array.prototype.slice.call(e,0,o)),t[o]=e[o]);return n.concat(t||Array.prototype.slice.call(e))}function c(a){var c,f=a.modals,l=function(n){return!(!n.open&&n.closedAt)||Date.now()-n.closedAt<300},s={all:c=c||new Map,on:function(n,e){var r=c.get(n);r?r.push(e):c.set(n,[e])},off:function(n,e){var r=c.get(n);r&&(e?r.splice(r.indexOf(e)>>>0,1):c.set(n,[]))},emit:function(n,e){var r=c.get(n);r&&r.slice().map((function(n){n(e)})),(r=c.get("*"))&&r.slice().map((function(r){r(n,e)}))}};var m=function(n){return s.emit("pop",{name:n})},v=function(n,e){var r=function(r){(r.name===n||"*"===n)&&e(r.open,r.props,r.name)};return s.on("change",r),function(){return s.off("change",r)}};return{ModalProvider:function(){var a=t([]),c=a[0],v=a[1];return r((function(){var n;return c.some((function(n){return"number"==typeof n.closedAt}))?n=setInterval((function(){v((function(n){return u([],n.filter(l),!0)}))}),100):clearInterval(n),function(){clearInterval(n)}}),[c]),r((function(){var n=function(n){var e=n.name,r=n.props;s.emit("change",{name:e,open:!0,props:r}),v((function(n){return u(u([],n,!0),[{key:Math.random().toString(),name:e,props:r,open:!0}],!1).filter(l)}))},e=function(n){var e=n.name,r=n.props;v((function(n){var t=n.findLast((function(n){return n.open}));return t&&s.emit("change",{name:t.name,open:!1,props:t.props}),s.emit("change",{name:e,open:!0,props:r}),u(u([],n.map((function(n){return n.key===(null==t?void 0:t.key)?i(i({},n),{open:!1,closedAt:Date.now()}):n})).filter(l),!0),[{key:Math.random().toString(),name:e,props:r,open:!0}],!1)}))},r=function(n){var e=n.name;v((function(n){var r=void 0===e?n.length-1:n.findLastIndex((function(n){return n.name===e&&n.open})),t=n[r];return t&&s.emit("change",{name:t.name,open:!1,props:t.props}),n.map((function(n){return(null==t?void 0:t.key)!==n.key?n:i(i({},n),{open:!1,closedAt:Date.now()})}))}))},t=function(){v((function(n){return n.map((function(n){return i(i({},n),{open:!1,closedAt:Date.now()})}))}))};return s.on("push",n),s.on("replace",e),s.on("pop",r),s.on("popAll",t),function(){s.off("push",n),s.off("replace",e),s.off("pop",r),s.off("popAll",t)}}),[c.length]),n(e,{children:c.map((function(e){var r=f[e.name],t="Component"in r?r.Component:r,a="Wrapper"in r?r.Wrapper:p.Root;return n(a,{open:e.open,onOpenChange:function(n){n||m(e.name)},defaultOpen:!0,children:n(o,{children:n(t,i({},e.props))})},e.key)}))})},pushModal:function(n){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var t=e[0];return s.emit("push",{name:n,props:null!=t?t:{}})},popModal:m,popAllModals:function(){return s.emit("popAll")},replaceWithModal:function(n){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];var t=e[0];s.emit("replace",{name:n,props:null!=t?t:{}})},onPushModal:v,useOnPushModal:function(n,e){r((function(){return v(n,e)}),[n,e])}}}function f(e){var r=e.mobile,o=e.desktop,p=e.breakpoint,u=void 0===p?640:p;function c(){var n=t(!1),e=n[0],r=n[1];return a((function(){var n=function(n){r(n.matches)},e=window.matchMedia("(max-width: ".concat(u,"px)"));return n(e),e.addEventListener("change",n),function(){e.removeEventListener("change",n)}}),[]),e}return{Wrapper:function(e){var t=c();return n(t?r.Wrapper:o.Wrapper,i({},e))},Content:function(e){var t=c();return n(t?r.Content:o.Content,i({},e))}}}"function"==typeof SuppressedError&&SuppressedError;export{c as createPushModal,f as createResponsiveWrapper};
//# sourceMappingURL=index.esm.js.map
